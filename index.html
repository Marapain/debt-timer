<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>fsociety_radio_ultimate</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #000000;
            --main-red: #ff2a2a;
            --low-glow: 0 0 5px rgba(255, 42, 42, 0.2);
            --glitch-shadow: 2px 0 #ff0000, -2px 0 #00ffff;
        }

        * { box-sizing: border-box; scrollbar-width: none; }
        ::-webkit-scrollbar { display: none; }

        body {
            margin: 0; padding: 0;
            background-color: var(--bg-color);
            color: var(--main-red);
            font-family: 'Press Start 2P', cursive;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            text-shadow: var(--low-glow);
        }

        /* --- UI Elements --- */
        .main-ui { text-align: center; z-index: 5; transition: 0.5s; }
        #track-display { font-size: 12px; margin-bottom: 20px; min-height: 1.5em; color: #aa0000; }
        #countdown { font-size: 18px; margin-bottom: 40px; }
        
        .ok-btn {
            background: transparent; color: var(--main-red);
            border: 2px solid var(--main-red); padding: 15px 40px;
            font-family: 'Press Start 2P', cursive; cursor: pointer;
            outline: none; transition: 0.3s;
        }
        .ok-btn:hover { background: var(--main-red); color: black; }

        /* --- Side Panel (Terminal) --- */
        .menu-trigger { position: fixed; top: 20px; left: 20px; cursor: pointer; z-index: 100; font-size: 14px; }
        
        .side-panel {
            position: fixed; top: 0; left: -100%; width: 550px; height: 100%; max-width: 100vw;
            background: #050000; border-right: 1px solid #200;
            transition: 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            padding: 40px 20px 20px 20px; z-index: 90;
            display: flex; flex-direction: column;
        }
        .side-panel.active { left: 0; }

        .close-menu {
            position: absolute; right: 20px; top: 20px; cursor: pointer; font-size: 16px;
        }

        .terminal-output {
            flex-grow: 1; overflow-y: auto; font-size: 10px;
            line-height: 1.8; margin-bottom: 10px; color: #800;
            transition: opacity 0.15s ease;
        }
        
        .input-line { display: flex; align-items: center; gap: 10px; font-size: 10px; }
        #term-input {
            background: transparent; border: none; color: var(--main-red);
            font-family: 'Press Start 2P', cursive; font-size: 10px;
            width: 100%; outline: none;
        }

        /* --- Animations & Easter Egg --- */
        #ascii-layer {
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            display: none; z-index: 1000; white-space: pre; font-size: 6px; pointer-events: none;
        }
        .glitch { animation: glitch-anim 0.2s infinite; }
        @keyframes glitch-anim {
            0% { transform: translate(-50%, -50%) skew(2deg); text-shadow: var(--glitch-shadow); }
            50% { transform: translate(-49%, -51%) skew(-2deg); text-shadow: -2px 0 red, 2px 0 cyan; }
            100% { transform: translate(-51%, -49%); }
        }

        @keyframes flicker-text {
            0% { opacity: 0; } 20% { opacity: 1; } 40% { opacity: 0.3; } 100% { opacity: 1; }
        }

        #elliot-mode {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); display: none; z-index: 2000;
            justify-content: center; align-items: center; text-align: center; line-height: 2;
        }
    </style>
</head>
<body>

    <div class="menu-trigger" onclick="toggleMenu()">>_ TERMINAL</div>

    <div id="elliot-mode">
        <div>
            <p id="elliot-text"></p>
        </div>
    </div>

    <div class="side-panel" id="side-panel">
        <div class="close-menu" onclick="toggleMenu()">></div>
        <div class="terminal-output" id="term-out">
            <div>fsociety_radio_os [Version 1.7.0.3]</div>
            <div>(c) IRA corp. All rights reserved.</div>
            <br>
        </div>
        <div class="input-line">
            <span>fsociety@radio:~$</span>
            <input type="text" id="term-input" autocomplete="off" spellcheck="false">
        </div>
    </div>

    <div class="main-ui" id="main-ui">
        <div id="track-display">NOT_CONNECTED</div>
        <div id="countdown">00D 00H 00M 00S</div>
        <button class="ok-btn" onclick="triggerOk()">OK</button>
    </div>

    <audio id="audio-player"></audio>

    <div id="ascii-layer">
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
XX                                                                          XX
XX   MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM   XX
XX   MMMMMMMMMMMMMMMMMMMMMssssssssssssssssssssssssssMMMMMMMMMMMMMMMMMMMMM   XX
XX   MMMMMMMMMMMMMMMMss'''                          '''ssMMMMMMMMMMMMMMMM   XX
XX   MMMMMMMMMMMMyy''                                    ''yyMMMMMMMMMMMM   XX
XX   MMMMMMMMyy''                                            ''yyMMMMMMMM   XX
XX   MMMMMy''                                                  ''yMMMMM   XX
XX   MMMy'                                                        'yMMM   XX
XX   Mh'                                                            'hM   XX
XX   -                                                                -   XX
XX                                                                          XX
XX   ::                                                              ::   XX
XX   MMhh.        ..hhhhhh..                    ..hhhhhh..        .hhMM   XX
XX   MMMMMh   ..hhMMMMMMMMMMhh.                .hhMMMMMMMMMMhh..   hMMMMM   XX
XX   ---MMM .hMMMMdd:::dMMMMMMMhh..        ..hhMMMMMMMd:::ddMMMMh. MMM---   XX
XX   MMMMMM MMmm''      'mmMMMMMMMMyy.  .yyMMMMMMMMmm'      ''mmMM MMMMMM   XX
XX   ---mMM ''             'mmMMMMMMMM  MMMMMMMMmm'             '' MMm---   XX
XX   yyyym'    .              'mMMMMm'  'mMMMMm'              .    'myyyy   XX
XX   mm''    .y'     ..yyyyy..  ''''      ''''  ..yyyyy..     'y.    ''mm   XX
XX           MN    .sMMMMMMMMMss.   .    .   .ssMMMMMMMMMs.    NM           XX
XX           N`    MMMMMMMMMMMMMN   M    M   NMMMMMMMMMMMMM    `N           XX
XX            +  .sMNNNNNMMMMMN+   `N    N`   +NMMMMMNNNNNMs.  +            XX
XX              o+++     ++++Mo    M      M    oM++++     +++o              XX
XX                               oo      oo                                 XX
XX           oM                oo          oo                Mo           XX
XX         oMMo                M              M                oMMo         XX
XX       +MMMM                 s              s                  MMMM+      XX
XX      +MMMMM+            +++NNNN+        +NNNN+++            +MMMMM+      XX
XX     +MMMMMMM+       ++NNMMMMMMMMN+    +NMMMMMMMMNN++       +MMMMMMM+     XX
XX     MMMMMMMMMNN+++NNMMMMMMMMMMMMMMNNNNMMMMMMMMMMMMMMNN+++NNMMMMMMMMM     XX
XX     yMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMy     XX
XX   m  yMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMy  m   XX
XX   MMm yMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMy mMM   XX
XX   MMMm .yyMMMMMMMMMMMMMMMM     MMMMMMMMMM     MMMMMMMMMMMMMMMMyy. mMMM   XX
XX   MMMMd   ''''hhhhh        odddo          obbbo        hhhh''''   dMMMM   XX
XX   MMMMMd             'hMMMMMMMMMMddddddMMMMMMMMMMh'             dMMMMM   XX
XX   MMMMMMd              'hMMMMMMMMMMMMMMMMMMMMMMh'              dMMMMMM   XX
XX   MMMMMMM-               ''ddMMMMMMMMMMMMMMdd''               -MMMMMMM   XX
XX   MMMMMMMM                   '::dddddddd::'                   MMMMMMMM   XX
XX   MMMMMMMM-                                                 -MMMMMMMM   XX
XX   MMMMMMMMM                                                 MMMMMMMMM   XX
XX   MMMMMMMMMy                                               yMMMMMMMMM   XX
XX   MMMMMMMMMMy.                                           .yMMMMMMMMMM   XX
XX   MMMMMMMMMMMMy.                                       .yMMMMMMMMMMMM   XX
XX   MMMMMMMMMMMMMMy.                                   .yMMMMMMMMMMMMMM   XX
XX   MMMMMMMMMMMMMMMMs.                                .sMMMMMMMMMMMMMMMM   XX
XX   MMMMMMMMMMMMMMMMMMss.            ....            .ssMMMMMMMMMMMMMMMMMM   XX
XX   MMMMMMMMMMMMMMMMMMMMNo         oNNNNo         oNMMMMMMMMMMMMMMMMMMMM   XX
XX                                                                          XX
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
    </div>

<script>
    // tracklist
    const playlist = [
        "1.0_1-hellofriend.wav.mp3", "1.0_2-oneincontrol.aiff.mp3", "1.0_3-fucksociety.mp3.mp3",
        "1.0_4-m0rphine.aac.mp3", "1.0_5-pierreloti.au.mp3", "1.0_6-leavem3here.flac.mp3",
        "1.0_7-waitfortheQ.ogg.mp3", "1.0_8-whatsyourask.m4p.mp3", "1.0_9-flipper.bwf.mp3",
        "1.1_1-one6away.caf.mp3", "1.1_2-wearefsociety.sd2.mp3", "1.1_3-oneor0.wma.mp3",
        "1.1_4-hateurself.ra.mp3", "1.1_5-illusionofchoice.mp3.mp3", "1.1_6-believe-in-erasing.au.mp3",
        "1.2_1-IwillbeCTO.m4p.mp3", "1.2_2-humanpunchingbag.aiff.mp3", "1.2_3-therealshayla.wav.mp3",
        "1.3_1-Ichosethis.ogg.mp3", "1.3_2-everyrev0lution.ra.mp3", "1.3_3-betterthanm0rphine.aac.mp3",
        "1.3_4-allsafevirus.bwf.mp3", "1.3_5-da3m0nsneverstop.caf.mp3", "1.4_1-squ4rewiththeuniverse.wma.mp3",
        "1.4_2-impenetrable.sd2.mp3", "1.4_3-billharper.mp3.mp3", "1.4_4-exploitingtyrell.wav.mp3",
        "1.4_5-revenge1syourweakn3ss.ra.mp3", "1.4_6-n0execution.au.mp3", 
        "MoiGuby.mp3" 
    ];

    // state
    let currentIndex = 0;
    let history = [];
    let historyIndex = -1;
    let lastMatches = [];
    let tabPressCount = 0;
    let previousVolume = 1;
    let isMuted = false;

    const audio = document.getElementById('audio-player');
    const termInput = document.getElementById('term-input');
    const termOut = document.getElementById('term-out');
    const trackDisplay = document.getElementById('track-display');

    // play track
    function playTrack(index) {
        if (currentIndex === index && !audio.paused && audio.src.includes(playlist[index])) return; 
        
        currentIndex = index;
        audio.src = playlist[currentIndex];
        audio.play().catch(() => console.log("browser blocked autoplay"));
        
        trackDisplay.innerText = playlist[currentIndex];
        trackDisplay.style.animation = "none";
        void trackDisplay.offsetWidth; 
        trackDisplay.style.animation = "flicker-text 0.4s";
    }

    // play next
    audio.onended = () => {
        currentIndex = (currentIndex + 1) % playlist.length;
        playTrack(currentIndex);
    };

    // smooth vol
    function smoothVolume(target) {
        let step = (target - audio.volume) / 20;
        let i = 0;
        clearInterval(window.volInterval);
        window.volInterval = setInterval(() => {
            audio.volume += step;
            i++;
            if (i >= 20 || audio.volume <= 0 || audio.volume >= 1) {
                audio.volume = Math.max(0, Math.min(1, target)); 
                clearInterval(window.volInterval);
            }
        }, 20);
    }

    // fuzzy search math
    function getLevenshtein(a, b) {
        const matrix = Array.from({ length: a.length + 1 }, (_, i) => [i]);
        for (let j = 1; j <= b.length; j++) matrix[0][j] = j;
        for (let i = 1; i <= a.length; i++) {
            for (let j = 1; j <= b.length; j++) {
                const cost = a[i - 1] === b[j - 1] ? 0 : 1;
                matrix[i][j] = Math.min(matrix[i - 1][j] + 1, matrix[i][j - 1] + 1, matrix[i - 1][j - 1] + cost);
            }
        }
        return matrix[a.length][b.length];
    }

    // main term logic
    function handleCommand(cmd) {
        const inputValue = cmd.trim().toLowerCase();
        if (!inputValue) return;

        // basic history
        history.push(cmd);
        historyIndex = history.length;
        
        // hide secret triggers from log
        if (inputValue !== 'clear' && inputValue !== 'doof' && inputValue !== 'itrololo1703') {
            printToTerm(`fsociety@radio:~$ ${cmd}`, "var(--main-red)");
        }
        
        tabPressCount = 0;

        // clear log
        if (inputValue === "clear") {
            termOut.style.opacity = "0";
            setTimeout(() => {
                termOut.innerHTML = "";
                termOut.style.opacity = "1";
            }, 150);
            return;
        }

        // show commands
        if (inputValue === "help") {
            printToTerm("Available commands:");
            printToTerm(" play");
            printToTerm(" pause");
            printToTerm(" stop");
            printToTerm(" next");
            printToTerm(" volume");
            printToTerm(" mute");
            printToTerm(" unmute");
            printToTerm(" listinfo");
            printToTerm(" clear");
            printToTerm(" help");
            return;
        }

        // print playlist
        if (inputValue === "listinfo") {
            printToTerm("Tracks available:");
            playlist.forEach((track, idx) => {
                printToTerm(` ${idx + 1}. ${track}`);
            });
            return;
        }

        // media controls
        if (inputValue === "pause") {
            audio.pause();
            printToTerm("Playback paused.");
            trackDisplay.style.animation = "none";
            return;
        }

        if (inputValue === "stop") {
            audio.pause();
            audio.currentTime = 0;
            printToTerm("Playback stopped.");
            trackDisplay.innerText = "NOT_CONNECTED";
            trackDisplay.style.animation = "none";
            return;
        }

        if (inputValue === "play") {
            if (audio.src && audio.paused) {
                audio.play();
                printToTerm("Playback resumed.");
                trackDisplay.style.animation = "flicker-text 0.4s";
            } else if (!audio.src) {
                playTrack(0);
                printToTerm(`PLAYING: ${playlist[0]}`);
            } else {
                printToTerm("Already playing.");
            }
            return;
        }

        // skip track
        if (inputValue === "next") {
            if (!audio.paused || !audio.src) {
                let nextIndex = currentIndex + 1;
                if (nextIndex >= playlist.length) nextIndex = 0;
                playTrack(nextIndex);
                printToTerm(`PLAYING: ${playlist[nextIndex]}`);
            } else {
                printToTerm("Cannot skip while stopped/paused.");
            }
            return;
        }

        // elliot
        if (inputValue === 'elliot') {
            triggerElliot();
            return;
        }

        // secret trigger
        if (inputValue === "doof" || inputValue === "itrololo1703") {
            const iraTrack = playlist.find(track => track.toLowerCase().includes("moi"));
            if (iraTrack) {
                const idx = playlist.indexOf(iraTrack);
                if (idx !== -1) {
                    playTrack(idx);
                }
            }
            return; 
        }

        // volume
        if (inputValue.startsWith("volume")) {
            const parts = inputValue.split(" ");
            if (parts.length === 1) {
                printToTerm("Current volume: " + Math.round(audio.volume * 100) + "%");
                return;
            }
            let value = parseFloat(parts[1]);
            if (isNaN(value)) {
                printToTerm("ERROR: INVALID_VOLUME_VALUE");
                return;
            }
            if (value > 1) value = value / 100;
            if (value < 0) value = 0;
            if (value > 1) value = 1;
            
            smoothVolume(value);
            isMuted = false;
            printToTerm("Volume set to " + Math.round(value * 100) + "%");
            return;
        }

        // mute toggle
        if (inputValue === "mute") {
            if (!isMuted) {
                previousVolume = audio.volume;
                smoothVolume(0);
                isMuted = true;
                printToTerm("System muted.");
            }
            return;
        }
        if (inputValue === "unmute") {
            if (isMuted) {
                smoothVolume(previousVolume);
                isMuted = false;
                printToTerm("System unmuted. Volume restored to " + Math.round(previousVolume * 100) + "%");
            }
            return;
        }

        // multi match
        if (lastMatches.length > 0 && !isNaN(inputValue)) {
            const num = parseInt(inputValue);
            if (num > 0 && num <= lastMatches.length) {
                const foundTrack = lastMatches[num - 1];
                const idx = playlist.indexOf(foundTrack);
                playTrack(idx);
                printToTerm(`PLAYING: ${foundTrack}`);
                lastMatches = [];
                return;
            }
        }

        // simple search
        let matches = playlist.filter(t => t.toLowerCase().includes(inputValue));

        // fuzzy fallback
        if (matches.length === 0) {
            matches = playlist
                .map(t => ({ name: t, dist: getLevenshtein(inputValue, t.toLowerCase()) }))
                .filter(res => res.dist <= 3) 
                .sort((a, b) => a.dist - b.dist)
                .slice(0, 5) 
                .map(res => res.name);
        }

        // play or list matches
        if (matches.length === 1) {
            const foundTrack = matches[0];
            playTrack(playlist.indexOf(foundTrack));
            printToTerm(`PLAYING: ${foundTrack}`);
            lastMatches = [];
        } else if (matches.length > 1) {
            lastMatches = matches;
            printToTerm(`MATCHES FOUND:`);
            matches.forEach((m, i) => printToTerm(` [${i + 1}] ${m}`));
            printToTerm(`Type number to select.`);
        } else {
            printToTerm(`ERROR: FILE_NOT_FOUND`, "#f00");
            lastMatches = [];
        }
    }

    // tab autocomplete
    function handleAutocomplete() {
        const val = termInput.value.toLowerCase();
        if (!val) return;

        const matches = playlist.filter(t => t.toLowerCase().includes(val));
        
        if (matches.length === 1) {
            termInput.value = matches[0];
        } else if (matches.length > 1) {
            if (tabPressCount === 0) {
                printToTerm(`fsociety@radio:~$ ${val}`, "var(--main-red)");
                printToTerm("AUTOCOMPLETE SUGGESTIONS:");
                matches.forEach(m => printToTerm(`  ${m}`));
                tabPressCount++;
            } else {
                let prefix = matches[0].toLowerCase();
                for(let i = 1; i < matches.length; i++) {
                    while(!matches[i].toLowerCase().startsWith(prefix)) {
                        prefix = prefix.slice(0, -1);
                    }
                }
                if(prefix.length > val.length) {
                    termInput.value = prefix;
                }
                tabPressCount = 0;
            }
        }
    }

    // keyboard events
    termInput.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') {
            handleCommand(termInput.value);
            termInput.value = '';
        }
        if (e.key === 'Tab') {
            e.preventDefault();
            handleAutocomplete();
        }
        if (e.key === 'ArrowUp') {
            e.preventDefault();
            if (historyIndex > 0) {
                historyIndex--;
                termInput.value = history[historyIndex];
            }
        }
        if (e.key === 'ArrowDown') {
            e.preventDefault();
            if (historyIndex < history.length - 1) {
                historyIndex++;
                termInput.value = history[historyIndex];
            } else {
                historyIndex = history.length;
                termInput.value = '';
            }
        }
        if (e.key !== 'Tab' && e.key !== 'Shift') {
            tabPressCount = 0; 
        }
    });

    // elliot stuff
    function triggerElliot() {
        const overlay = document.getElementById('elliot-mode');
        const text = document.getElementById('elliot-text');
        overlay.style.display = 'flex';
        
        const lines = ["Hello, friend.", "We are fsociety.", "Are you a 1 or a 0?"];
        let i = 0;
        text.innerText = "";
        
        const interval = setInterval(() => {
            text.innerText += (i > 0 ? "\n" : "") + lines[i];
            i++;
            if(i >= lines.length) {
                clearInterval(interval);
                setTimeout(() => {
                    overlay.style.display = 'none';
                    playTrack(0); 
                }, 3000);
            }
        }, 1500);
    }

    // utils
    function printToTerm(txt, color = "#800") {
        const div = document.createElement('div');
        div.style.color = color;
        div.innerText = txt;
        termOut.appendChild(div);
        termOut.scrollTop = termOut.scrollHeight;
    }

    // side panel
    function toggleMenu() {
        const panel = document.getElementById('side-panel');
        panel.classList.toggle('active');
        if(panel.classList.contains('active')) {
            setTimeout(() => termInput.focus(), 100);
        }
    }

    function triggerOk() {
        const ascii = document.getElementById('ascii-layer');
        ascii.style.display = 'block';
        ascii.classList.add('glitch');
        setTimeout(() => {
            ascii.style.display = 'none';
            ascii.classList.remove('glitch');
        }, 3000);
    }

    // timer
    const target = new Date("January 1, 2027 00:00:00").getTime();
    setInterval(() => {
        const now = new Date().getTime();
        const diff = target - now;
        if(diff < 0) {
            document.getElementById('countdown').innerText = "HAPPY NEW YEAR";
            return;
        }
        const d = Math.floor(diff / (86400000));
        const h = Math.floor((diff % 86400000) / 3600000);
        const m = Math.floor((diff % 3600000) / 60000);
        const s = Math.floor((diff % 60000) / 1000);
        document.getElementById('countdown').innerText = 
            `${String(d).padStart(2,'0')}D ${String(h).padStart(2,'0')}H ${String(m).padStart(2,'0')}M ${String(s).padStart(2,'0')}S`;
    }, 1000);

</script>
</body>
</html>